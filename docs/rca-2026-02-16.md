# RCA: Gagal Memuat Aplikasi (Startup Error)

## Ringkasan
Terjadi kegagalan pemuatan aplikasi yang memunculkan overlay “Gagal memuat aplikasi”. Insiden dipicu oleh error runtime di renderer yang tidak tertangani sehingga proses init berhenti sebelum UI stabil.

## Dampak
- Aplikasi tidak bisa digunakan saat error terjadi.
- Pengguna hanya melihat overlay error tanpa detail yang mudah disalin.

## Lingkungan
- OS: Windows (desktop)
- Node: v24.13.0
- npm: 11.6.2
- Electron: ^28.0.0
- Mode: Desktop app (file://) dengan IPC melalui preload

## Bukti dan Data
- Overlay startup error aktif karena event `error` dan `unhandledrejection`.
- Log detail kini tersimpan di `localStorage` dengan key `streakly_startup_errors`.
- Informasi runtime bisa ditarik lewat IPC `get-runtime-info`.

## Akar Masalah
Renderer dapat crash saat:
- IPC bridge tidak tersedia (preload gagal atau diblokir), sehingga `window.api` undefined dan memicu error pada akses pertama.
- Utilitas kalender `CalendarUtils` tidak ter-load namun fungsi render tetap dipanggil.

## Langkah Reproduksi Minimal
1. Jalankan aplikasi tanpa preload yang valid atau dengan preload gagal load.
2. Tunggu renderer memanggil fungsi yang mengakses `window.api`.
3. Overlay “Gagal memuat aplikasi” muncul.

## Perbaikan yang Diterapkan
- Fallback IPC: `window.api` diproteksi dengan Proxy agar pemanggilan IPC yang tidak tersedia mengembalikan error terstruktur.
- Guard kalender: `renderMonthCalendar` menghentikan eksekusi jika `CalendarUtils` tidak tersedia.
- Diagnostik startup: menyimpan payload lengkap (timestamp, stack, user agent, runtime) dan menampilkan detail yang bisa disalin.

## Validasi
- `npm test` lulus.
- `npm run build` gagal di sandbox karena pembatasan akses cache Electron; perlu dijalankan di environment lokal non-sandbox.

## Tindak Lanjut
- Pantau error rate lewat data yang tersimpan di `streakly_startup_errors`.
- Tambahkan automation untuk snapshot dan Lighthouse di CI agar regresi UI terdeteksi lebih awal.
